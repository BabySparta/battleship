(()=>{"use strict";const t=class{constructor(t){this.name=t,this.ships=[],this.gameboard=new class{constructor(){this.board=this.#t(),this.missed=[],this.ships=[]}#t(){let t=[];for(let e=0;e<10;e++){let e=[];for(let t=0;t<10;t++)e.push({isHit:!1,hasShip:!1});t.push(e)}return t}placeShip(t,e,a,r){if(this.#e(e,a,t,r)){const o=[];for(let d=0;d<t;d++)"hori"===r&&(o.push([e+d,a]),this.board[a][e+d].hasShip=!0),"vert"===r&&(o.push([e,a+d]),this.board[a+d][e].hasShip=!0);const d=new class{constructor(t,e){this.name=t,this.location=e,this.hits=[]}hit(t){this.hits.push(t)}isSunk(){return this.location.sort().toString()===this.hits.sort().toString()}}("ship",o);return this.ships.push(d),d}return"Not a valid spot"}recieveAttack(t,e){if(this.board[e][t].hasShip){let a;for(let r=0;r<this.ships.length;r++)this.#a(this.ships[r].location,[t,e])&&(a=this.ships[r]);return a.hit([t,e]),this.board[e][t].isHit=!0,a.isSunk(),a.hits}return this.missed.push([t,e]),this.board[e][t].isHit=!0,this.missed}allShipsSunk(){let t=!0;return this.ships.forEach((e=>{e.isSunk()||(t=!1)})),t}#e(t,e,a,r){let o=!0;for(let d=0;d<a;d++)"hori"===r&&(0<=t+d&&t+d<10&&0<=e&&e<10?this.ships.forEach((a=>{this.#a(a.location,[t+d,e])&&(o=!1)})):o=!1),"vert"===r&&(0<=t&&t<10&&0<=e+d&&e+d<10?this.ships.forEach((a=>{this.#a(a.location,[t,e+d])&&(o=!1)})):o=!1);return o}#a(t,e){const a=JSON.stringify(e);return t.some((function(t){return JSON.stringify(t)===a}))}}}attack(t,e,a){if(a.board[e][t].isHit)return"You already shot there";a.recieveAttack(t,e)}autoAttack(t){const e=Math.round(9*Math.random()),a=Math.round(9*Math.random());t.board[a][e].isHit?this.autoAttack(t):t.recieveAttack(e,a)}},e=()=>Math.floor(10*Math.random()),a=function(){const a=new t("user");[r,o,d,l,s].forEach((t=>{a.gameboard.placeShip(t[3],t[0],t[1],t[2])}));const c=new t("AI");let i=5;for(;5!==c.gameboard.ships.length;){const t=e(),a=e(),r=0===Math.round(Math.random())?"hori":"vert";1===c.gameboard.ships.length&&(i=4),2===c.gameboard.ships.length&&(i=3),3===c.gameboard.ships.length&&(i=3),4===c.gameboard.ships.length&&(i=2),c.gameboard.placeShip(i,t,a,r)}document.querySelectorAll(".oppCell").forEach((t=>{t.addEventListener("click",(()=>{if(t.firstChild)return;const e=parseInt(t.getAttribute("data-x")),r=parseInt(t.getAttribute("data-y")),o=c.gameboard.missed.length;a.attack(e,r,c.gameboard),o<c.gameboard.missed.length?(t=>{const e=document.createElement("div");e.classList.add("miss"),t.appendChild(e)})(t):(t=>{const e=document.createElement("div");e.classList.add("hit"),t.appendChild(e)})(t),c.autoAttack(a.gameboard)}))}))};let r,o,d,l,s,c="hori",i=1;function n(t){if(6===i)return;const e=parseInt(t.getAttribute("data-x")),a=parseInt(t.getAttribute("data-y"));let r=document.querySelector(`.modalCell[data-x="${e+1}"][data-y="${a}"]`),o=document.querySelector(`.modalCell[data-x="${e+2}"][data-y="${a}"]`),d=document.querySelector(`.modalCell[data-x="${e+3}"][data-y="${a}"]`),l=document.querySelector(`.modalCell[data-x="${e+4}"][data-y="${a}"]`);"vert"===c&&(r=document.querySelector(`.modalCell[data-x="${e}"][data-y="${a+1}"]`),o=document.querySelector(`.modalCell[data-x="${e}"][data-y="${a+2}"]`),d=document.querySelector(`.modalCell[data-x="${e}"][data-y="${a+3}"]`),l=document.querySelector(`.modalCell[data-x="${e}"][data-y="${a+4}"]`));let s=[t,r,o,d,l];s=u(s);let n=!0,m=!1;s.forEach((t=>{t?t.classList.contains("occupied")&&(m=!0):n=!1})),n?(m&&t.classList.remove("placeError"),s.forEach((t=>{t.classList.remove("placeHover")})),t.firstChild&&t.classList.remove("alreadyPlacedError")):t.classList.remove("placeError")}function u(t){return 1===i?t:2===i?t.slice(0,4):3===i||4==i?t.slice(0,3):5===i?t.slice(0,2):void 0}document.querySelectorAll(".board").forEach((t=>{for(let e=0;e<10;e++){let a=document.createElement("div");for(let r=0;r<10;r++){let o=document.createElement("div");o.classList.add("cell"),t.classList.contains("opponent")&&o.classList.add("oppCell"),t.classList.contains("player")&&o.classList.add("userCell"),t.classList.contains("modalBoard")&&o.classList.add("modalCell"),o.dataset.x=r,o.dataset.y=e,a.appendChild(o)}a.classList.add("row"),t.appendChild(a)}})),(()=>{document.querySelectorAll(".modalCell").forEach((t=>{t.addEventListener("mouseenter",(()=>function(t){if(6===i)return;if(t.firstChild)return void t.classList.add("alreadyPlacedError");const e=parseInt(t.getAttribute("data-x")),a=parseInt(t.getAttribute("data-y"));let r=document.querySelector(`.modalCell[data-x="${e+1}"][data-y="${a}"]`),o=document.querySelector(`.modalCell[data-x="${e+2}"][data-y="${a}"]`),d=document.querySelector(`.modalCell[data-x="${e+3}"][data-y="${a}"]`),l=document.querySelector(`.modalCell[data-x="${e+4}"][data-y="${a}"]`);"vert"===c&&(r=document.querySelector(`.modalCell[data-x="${e}"][data-y="${a+1}"]`),o=document.querySelector(`.modalCell[data-x="${e}"][data-y="${a+2}"]`),d=document.querySelector(`.modalCell[data-x="${e}"][data-y="${a+3}"]`),l=document.querySelector(`.modalCell[data-x="${e}"][data-y="${a+4}"]`));let s=[t,r,o,d,l];s=u(s);let n=!0;s.forEach((t=>{t?t.classList.contains("occupied")&&(n=!1):n=!1})),n?s.forEach((t=>{t.classList.add("placeHover")})):t.classList.add("placeError")}(t))),t.addEventListener("mouseleave",(()=>n(t))),t.addEventListener("click",(()=>function(t){if(1===i){const e=parseInt(t.getAttribute("data-x")),a=parseInt(t.getAttribute("data-y"));let o=document.querySelector(`.modalCell[data-x="${e+1}"][data-y="${a}"]`),d=document.querySelector(`.modalCell[data-x="${e+2}"][data-y="${a}"]`),l=document.querySelector(`.modalCell[data-x="${e+3}"][data-y="${a}"]`),s=document.querySelector(`.modalCell[data-x="${e+4}"][data-y="${a}"]`);if("vert"===c&&(o=document.querySelector(`.modalCell[data-x="${e}"][data-y="${a+1}"]`),d=document.querySelector(`.modalCell[data-x="${e}"][data-y="${a+2}"]`),l=document.querySelector(`.modalCell[data-x="${e}"][data-y="${a+3}"]`),s=document.querySelector(`.modalCell[data-x="${e}"][data-y="${a+4}"]`)),!(o&&d&&l&&s))return;const u=[t,o,d,l,s];let m=!1;if(u.forEach((t=>{t.classList.contains("occupied")&&(m=!0)})),m)return;const h=document.createElement("img");return h.classList.add("carrier"),"vert"===c&&h.classList.add("vertical"),h.src="./resources/carrier.png",t.appendChild(h),u.forEach((t=>{t.classList.add("occupied")})),n(t),i++,document.querySelector(".modalTitle").textContent="PLACE YOUR BATTLESHIP",void(r=[e,a,c,5])}if(2===i){const e=parseInt(t.getAttribute("data-x")),a=parseInt(t.getAttribute("data-y"));let r=document.querySelector(`.modalCell[data-x="${e+1}"][data-y="${a}"]`),d=document.querySelector(`.modalCell[data-x="${e+2}"][data-y="${a}"]`),l=document.querySelector(`.modalCell[data-x="${e+3}"][data-y="${a}"]`);if("vert"===c&&(r=document.querySelector(`.modalCell[data-x="${e}"][data-y="${a+1}"]`),d=document.querySelector(`.modalCell[data-x="${e}"][data-y="${a+2}"]`),l=document.querySelector(`.modalCell[data-x="${e}"][data-y="${a+3}"]`)),!r||!d||!l)return;const s=[t,r,d,l];let u=!1;if(s.forEach((t=>{t.classList.contains("occupied")&&(u=!0)})),u)return;const m=document.createElement("img");return m.classList.add("battleship"),"vert"===c&&m.classList.add("vertical"),m.src="./resources/battleship.png",t.appendChild(m),s.forEach((t=>{t.classList.add("occupied")})),n(t),i++,document.querySelector(".modalTitle").textContent="PLACE YOUR CRUISER",void(o=[e,a,c,4])}if(3===i){const e=parseInt(t.getAttribute("data-x")),a=parseInt(t.getAttribute("data-y"));let r=document.querySelector(`.modalCell[data-x="${e+1}"][data-y="${a}"]`),o=document.querySelector(`.modalCell[data-x="${e+2}"][data-y="${a}"]`);if("vert"===c&&(r=document.querySelector(`.modalCell[data-x="${e}"][data-y="${a+1}"]`),o=document.querySelector(`.modalCell[data-x="${e}"][data-y="${a+2}"]`)),!r||!o)return;const l=[t,r,o];let s=!1;if(l.forEach((t=>{t.classList.contains("occupied")&&(s=!0)})),s)return;const u=document.createElement("img");return u.classList.add("cruiser"),"vert"===c&&u.classList.add("vertical"),u.src="./resources/cruiser.png",t.appendChild(u),l.forEach((t=>{t.classList.add("occupied")})),n(t),i++,document.querySelector(".modalTitle").textContent="PLACE YOUR SUBMARINE",void(d=[e,a,c,3])}if(4===i){const e=parseInt(t.getAttribute("data-x")),a=parseInt(t.getAttribute("data-y"));let r=document.querySelector(`.modalCell[data-x="${e+1}"][data-y="${a}"]`),o=document.querySelector(`.modalCell[data-x="${e+2}"][data-y="${a}"]`);if("vert"===c&&(r=document.querySelector(`.modalCell[data-x="${e}"][data-y="${a+1}"]`),o=document.querySelector(`.modalCell[data-x="${e}"][data-y="${a+2}"]`)),!r||!o)return;const d=[t,r,o];let s=!1;if(d.forEach((t=>{t.classList.contains("occupied")&&(s=!0)})),s)return;const u=document.createElement("img");return u.classList.add("submarine"),"vert"===c&&u.classList.add("vertical"),u.src="./resources/submarine.png",t.appendChild(u),d.forEach((t=>{t.classList.add("occupied")})),n(t),i++,document.querySelector(".modalTitle").textContent="PLACE YOUR DESTROYER",void(l=[e,a,c,3])}if(5===i){const e=parseInt(t.getAttribute("data-x")),r=parseInt(t.getAttribute("data-y"));let o=document.querySelector(`.modalCell[data-x="${e+1}"][data-y="${r}"]`);if("vert"===c&&(o=document.querySelector(`.modalCell[data-x="${e}"][data-y="${r+1}"]`)),!o)return;const d=[t,o];let l=!1;if(d.forEach((t=>{t.classList.contains("occupied")&&(l=!0)})),l)return;const u=document.createElement("img");u.classList.add("destroyer"),"vert"===c&&u.classList.add("vertical"),u.src="./resources/destroyer.png",t.appendChild(u),d.forEach((t=>{t.classList.add("occupied")})),n(t),i++,s=[e,r,c,2],document.querySelector(".placeModal").style.display="none",a()}}(t)))}));const t=document.querySelector(".changeAxis");t.addEventListener("click",(()=>{"X"===t.textContent.charAt(6)?(t.textContent="AXIS: Y",c="vert"):(t.textContent="AXIS: X",c="hori")}))})()})();