(()=>{"use strict";const t=class{constructor(t){this.name=t,this.ships=[],this.gameboard=new class{constructor(){this.board=this.#t(),this.missed=[],this.ships=[]}#t(){let t=[];for(let e=0;e<10;e++){let e=[];for(let t=0;t<10;t++)e.push({isHit:!1,hasShip:!1});t.push(e)}return t}placeShip(t,e,a,r){if(this.#e(e,a,t,r)){const o=[];for(let d=0;d<t;d++)"hori"===r&&(o.push([e+d,a]),this.board[a][e+d].hasShip=!0),"vert"===r&&(o.push([e,a+d]),this.board[a+d][e].hasShip=!0);const d=new class{constructor(t,e){this.name=t,this.location=e,this.hits=[]}hit(t){this.hits.push(t)}isSunk(){return this.location.sort().toString()===this.hits.sort().toString()}}("ship",o);return this.ships.push(d),d}return"Not a valid spot"}recieveAttack(t,e){if(this.board[e][t].hasShip){let a;for(let r=0;r<this.ships.length;r++)this.#a(this.ships[r].location,[t,e])&&(a=this.ships[r]);return a.hit([t,e]),this.board[e][t].isHit=!0,a.hits}return this.missed.push([t,e]),this.board[e][t].isHit=!0,this.missed}allShipsSunk(){let t=!0;return this.ships.forEach((e=>{e.isSunk()||(t=!1)})),t}#e(t,e,a,r){let o=!0;for(let d=0;d<a;d++)"hori"===r&&(0<=t+d&&t+d<10&&0<=e&&e<10?this.ships.forEach((a=>{this.#a(a.location,[t+d,e])&&(o=!1)})):o=!1),"vert"===r&&(0<=t&&t<10&&0<=e+d&&e+d<10?this.ships.forEach((a=>{this.#a(a.location,[t,e+d])&&(o=!0)})):o=!1);return o}#a(t,e){const a=JSON.stringify(e);return t.some((function(t){return JSON.stringify(t)===a}))}}}attack(t,e,a){if(a.board[e][t].isHit)return"You already shot there";a.recieveAttack(t,e)}autoAttack(t){const e=Math.round(7*Math.random()),a=Math.round(7*Math.random());t.board[a][e].isHit?autoAttack(t):t.recieveAttack(e,a)}},e=()=>Math.floor(10*Math.random());let a,r,o,d,l,s="hori",c=1;function i(t){if(6===c)return;const e=parseInt(t.getAttribute("data-x")),a=parseInt(t.getAttribute("data-y"));let r=document.querySelector(`.modalCell[data-x="${e+1}"][data-y="${a}"]`),o=document.querySelector(`.modalCell[data-x="${e+2}"][data-y="${a}"]`),d=document.querySelector(`.modalCell[data-x="${e+3}"][data-y="${a}"]`),l=document.querySelector(`.modalCell[data-x="${e+4}"][data-y="${a}"]`);"vert"===s&&(r=document.querySelector(`.modalCell[data-x="${e}"][data-y="${a+1}"]`),o=document.querySelector(`.modalCell[data-x="${e}"][data-y="${a+2}"]`),d=document.querySelector(`.modalCell[data-x="${e}"][data-y="${a+3}"]`),l=document.querySelector(`.modalCell[data-x="${e}"][data-y="${a+4}"]`));let i=[t,r,o,d,l];i=n(i);let u=!0,m=!1;i.forEach((t=>{t?t.classList.contains("occupied")&&(m=!0):u=!1})),u?(m&&t.classList.remove("placeError"),i.forEach((t=>{t.classList.remove("placeHover")})),t.firstChild&&t.classList.remove("alreadyPlacedError")):t.classList.remove("placeError")}function n(t){return 1===c?t:2===c?t.slice(0,4):3===c||4==c?t.slice(0,3):5===c?t.slice(0,2):void 0}document.querySelectorAll(".board").forEach((t=>{for(let e=0;e<10;e++){let a=document.createElement("div");for(let r=0;r<10;r++){let o=document.createElement("div");o.classList.add("cell"),t.classList.contains("opponent")&&o.classList.add("oppCell"),t.classList.contains("player")&&o.classList.add("userCell"),t.classList.contains("modalBoard")&&o.classList.add("modalCell"),o.dataset.x=r,o.dataset.y=e,a.appendChild(o)}a.classList.add("row"),t.appendChild(a)}})),(()=>{document.querySelectorAll(".modalCell").forEach((u=>{u.addEventListener("mouseenter",(()=>function(t){if(6===c)return;if(t.firstChild)return void t.classList.add("alreadyPlacedError");const e=parseInt(t.getAttribute("data-x")),a=parseInt(t.getAttribute("data-y"));let r=document.querySelector(`.modalCell[data-x="${e+1}"][data-y="${a}"]`),o=document.querySelector(`.modalCell[data-x="${e+2}"][data-y="${a}"]`),d=document.querySelector(`.modalCell[data-x="${e+3}"][data-y="${a}"]`),l=document.querySelector(`.modalCell[data-x="${e+4}"][data-y="${a}"]`);"vert"===s&&(r=document.querySelector(`.modalCell[data-x="${e}"][data-y="${a+1}"]`),o=document.querySelector(`.modalCell[data-x="${e}"][data-y="${a+2}"]`),d=document.querySelector(`.modalCell[data-x="${e}"][data-y="${a+3}"]`),l=document.querySelector(`.modalCell[data-x="${e}"][data-y="${a+4}"]`));let i=[t,r,o,d,l];i=n(i);let u=!0;i.forEach((t=>{t?t.classList.contains("occupied")&&(u=!1):u=!1})),u?i.forEach((t=>{t.classList.add("placeHover")})):t.classList.add("placeError")}(u))),u.addEventListener("mouseleave",(()=>i(u))),u.addEventListener("click",(()=>function(n){if(1===c){const t=parseInt(n.getAttribute("data-x")),e=parseInt(n.getAttribute("data-y"));let r=document.querySelector(`.modalCell[data-x="${t+1}"][data-y="${e}"]`),o=document.querySelector(`.modalCell[data-x="${t+2}"][data-y="${e}"]`),d=document.querySelector(`.modalCell[data-x="${t+3}"][data-y="${e}"]`),l=document.querySelector(`.modalCell[data-x="${t+4}"][data-y="${e}"]`);if("vert"===s&&(r=document.querySelector(`.modalCell[data-x="${t}"][data-y="${e+1}"]`),o=document.querySelector(`.modalCell[data-x="${t}"][data-y="${e+2}"]`),d=document.querySelector(`.modalCell[data-x="${t}"][data-y="${e+3}"]`),l=document.querySelector(`.modalCell[data-x="${t}"][data-y="${e+4}"]`)),!(r&&o&&d&&l))return;const u=[n,r,o,d,l];let m=!1;if(u.forEach((t=>{t.classList.contains("occupied")&&(m=!0)})),m)return;const h=document.createElement("img");return h.classList.add("carrier"),"vert"===s&&h.classList.add("vertical"),h.src="./resources/carrier.png",n.appendChild(h),u.forEach((t=>{t.classList.add("occupied")})),i(n),c++,document.querySelector(".modalTitle").textContent="PLACE YOUR BATTLESHIP",void(a=[t,e,s,5])}if(2===c){const t=parseInt(n.getAttribute("data-x")),e=parseInt(n.getAttribute("data-y"));let a=document.querySelector(`.modalCell[data-x="${t+1}"][data-y="${e}"]`),o=document.querySelector(`.modalCell[data-x="${t+2}"][data-y="${e}"]`),d=document.querySelector(`.modalCell[data-x="${t+3}"][data-y="${e}"]`);if("vert"===s&&(a=document.querySelector(`.modalCell[data-x="${t}"][data-y="${e+1}"]`),o=document.querySelector(`.modalCell[data-x="${t}"][data-y="${e+2}"]`),d=document.querySelector(`.modalCell[data-x="${t}"][data-y="${e+3}"]`)),!a||!o||!d)return;const l=[n,a,o,d];let u=!1;if(l.forEach((t=>{t.classList.contains("occupied")&&(u=!0)})),u)return;const m=document.createElement("img");return m.classList.add("battleship"),"vert"===s&&m.classList.add("vertical"),m.src="./resources/battleship.png",n.appendChild(m),l.forEach((t=>{t.classList.add("occupied")})),i(n),c++,document.querySelector(".modalTitle").textContent="PLACE YOUR CRUISER",void(r=[t,e,s,4])}if(3===c){const t=parseInt(n.getAttribute("data-x")),e=parseInt(n.getAttribute("data-y"));let a=document.querySelector(`.modalCell[data-x="${t+1}"][data-y="${e}"]`),r=document.querySelector(`.modalCell[data-x="${t+2}"][data-y="${e}"]`);if("vert"===s&&(a=document.querySelector(`.modalCell[data-x="${t}"][data-y="${e+1}"]`),r=document.querySelector(`.modalCell[data-x="${t}"][data-y="${e+2}"]`)),!a||!r)return;const d=[n,a,r];let l=!1;if(d.forEach((t=>{t.classList.contains("occupied")&&(l=!0)})),l)return;const u=document.createElement("img");return u.classList.add("cruiser"),"vert"===s&&u.classList.add("vertical"),u.src="./resources/cruiser.png",n.appendChild(u),d.forEach((t=>{t.classList.add("occupied")})),i(n),c++,document.querySelector(".modalTitle").textContent="PLACE YOUR SUBMARINE",void(o=[t,e,s,3])}if(4===c){const t=parseInt(n.getAttribute("data-x")),e=parseInt(n.getAttribute("data-y"));let a=document.querySelector(`.modalCell[data-x="${t+1}"][data-y="${e}"]`),r=document.querySelector(`.modalCell[data-x="${t+2}"][data-y="${e}"]`);if("vert"===s&&(a=document.querySelector(`.modalCell[data-x="${t}"][data-y="${e+1}"]`),r=document.querySelector(`.modalCell[data-x="${t}"][data-y="${e+2}"]`)),!a||!r)return;const o=[n,a,r];let l=!1;if(o.forEach((t=>{t.classList.contains("occupied")&&(l=!0)})),l)return;const u=document.createElement("img");return u.classList.add("submarine"),"vert"===s&&u.classList.add("vertical"),u.src="./resources/submarine.png",n.appendChild(u),o.forEach((t=>{t.classList.add("occupied")})),i(n),c++,document.querySelector(".modalTitle").textContent="PLACE YOUR DESTROYER",void(d=[t,e,s,3])}if(5===c){const u=parseInt(n.getAttribute("data-x")),m=parseInt(n.getAttribute("data-y"));let h=document.querySelector(`.modalCell[data-x="${u+1}"][data-y="${m}"]`);if("vert"===s&&(h=document.querySelector(`.modalCell[data-x="${u}"][data-y="${m+1}"]`)),!h)return;const y=[n,h];let p=!1;if(y.forEach((t=>{t.classList.contains("occupied")&&(p=!0)})),p)return;const $=document.createElement("img");$.classList.add("destroyer"),"vert"===s&&$.classList.add("vertical"),$.src="./resources/destroyer.png",n.appendChild($),y.forEach((t=>{t.classList.add("occupied")})),i(n),c++,l=[u,m,s,2],document.querySelector(".placeModal").style.display="none",function(){const s=new t("user");[a,r,o,d,l].forEach((t=>{s.gameboard.placeShip(t[3],t[0],t[1],t[2])})),document.querySelectorAll(".oppCell").forEach((t=>{t.addEventListener("click",(()=>{const e=t.getAttribute("data-x"),a=t.getAttribute("data-y");s.attack(e,a,c.gameboard),c.autoAttack(s.gameboard),console.log(s.gameboard,c.gameboard)}))}));const c=new t("AI");let i=5;for(;5!==c.gameboard.ships.length;){const t=e(),a=e(),r=0===Math.round(Math.random())?"hori":"vert";1===c.gameboard.ships.length&&(i=4),2===c.gameboard.ships.length&&(i=3),3===c.gameboard.ships.length&&(i=3),4===c.gameboard.ships.length&&(i=2),c.gameboard.placeShip(i,t,a,r)}}()}}(u)))}));const u=document.querySelector(".changeAxis");u.addEventListener("click",(()=>{"X"===u.textContent.charAt(6)?(u.textContent="AXIS: Y",s="vert"):(u.textContent="AXIS: X",s="hori")}))})()})();