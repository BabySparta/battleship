(()=>{"use strict";const t=class{constructor(t){this.name=t,this.ships=[],this.gameboard=new class{constructor(){this.board=this.#t(),this.missed=[],this.ships=[]}#t(){let t=[];for(let e=0;e<10;e++){let e=[];for(let t=0;t<10;t++)e.push({isHit:!1,hasShip:!1});t.push(e)}return t}placeShip(t,e,a,r){if(this.#e(e,a,t,r)){const s=[];for(let o=0;o<t;o++)"hori"===r&&(s.push([e+o,a]),this.board[a][e+o].hasShip=!0),"vert"===r&&(s.push([e,a+o]),this.board[a+o][e].hasShip=!0);const o=new class{constructor(t,e){this.name=t,this.location=e,this.hits=[]}hit(t){this.hits.push(t)}isSunk(){return this.location.sort().toString()===this.hits.sort().toString()}}("ship",s);return this.ships.push(o),o}return"Not a valid spot"}recieveAttack(t,e){if(this.board[e][t].hasShip){let a;for(let r=0;r<this.ships.length;r++)this.#a(this.ships[r].location,[t,e])&&(a=this.ships[r]);return a.hit([t,e]),this.board[e][t].isHit=!0,a.isSunk(),a.hits}return this.missed.push([t,e]),this.board[e][t].isHit=!0,this.missed}allShipsSunk(){let t=!0;return this.ships.forEach((e=>{e.isSunk()||(t=!1)})),t}#e(t,e,a,r){let s=!0;for(let o=0;o<a;o++)"hori"===r&&(0<=t+o&&t+o<10&&0<=e&&e<10?this.ships.forEach((a=>{this.#a(a.location,[t+o,e])&&(s=!1)})):s=!1),"vert"===r&&(0<=t&&t<10&&0<=e+o&&e+o<10?this.ships.forEach((a=>{this.#a(a.location,[t,e+o])&&(s=!1)})):s=!1);return s}#a(t,e){const a=JSON.stringify(e);return t.some((function(t){return JSON.stringify(t)===a}))}}}attack(t,e,a){if(a.board[e][t].isHit)return"You already shot there";a.recieveAttack(t,e)}autoAttack(t){const e=Math.round(9*Math.random()),a=Math.round(9*Math.random());return!t.board[a][e].isHit&&(t.recieveAttack(e,a),[e,a])}},e=()=>Math.floor(10*Math.random()),a=t=>{const e=document.createElement("div");e.classList.add("miss"),t.appendChild(e)},r=t=>{const e=document.createElement("div");e.classList.add("hit"),t.appendChild(e)},s=(t,e,a)=>{const r=t.location[0][0],s=t.location[0][1],d=o(t),l=document.querySelector(`.${a}[data-x="${r}"][data-y="${s}"]`),c=document.createElement("img");"vert"===d&&c.classList.add("vertical"),c.classList.add("playerShip"),0===e&&(c.classList.add("carrier"),c.classList.add("oppShip"),c.src="./resources/carrier.png"),1===e&&(c.classList.add("battleship"),c.classList.add("oppShip"),c.src="./resources/battleship.png"),2===e&&(c.classList.add("cruiser"),c.classList.add("oppShip"),c.src="./resources/cruiser.png"),3===e&&(c.classList.add("submarine"),c.classList.add("oppShip"),c.src="./resources/submarine.png"),4===e&&(c.classList.add("destroyer"),c.classList.add("oppShip"),c.src="./resources/destroyer.png"),l.appendChild(c),"oppCell"===a&&(c.style.opacity=0)},o=t=>t.location[0][0]===t.location[1][0]?"vert":"hori",d=function(){const o=new t("user"),d=[l,c,i,n,u];d.forEach((t=>{o.gameboard.placeShip(t[3],t[0],t[1],t[2]),s(o.gameboard.ships.slice(-1)[0],d.indexOf(t),"userCell")}));const m=new t("AI");let h=5;for(;5!==m.gameboard.ships.length;){const t=e(),a=e(),r=0===Math.round(Math.random())?"hori":"vert";1===m.gameboard.ships.length&&(h=4),2===m.gameboard.ships.length&&(h=3),3===m.gameboard.ships.length&&(h=3),4===m.gameboard.ships.length&&(h=2),m.gameboard.placeShip(h,t,a,r)}m.gameboard.ships.forEach((t=>{s(t,m.gameboard.ships.indexOf(t),"oppCell")})),document.querySelectorAll(".oppCell").forEach((t=>{t.addEventListener("click",(()=>{if(t.lastChild&&(t.lastChild.classList.contains("hit")||t.lastChild.classList.contains("miss")))return;const e=parseInt(t.getAttribute("data-x")),s=parseInt(t.getAttribute("data-y")),d=m.gameboard.missed.length;o.attack(e,s,m.gameboard),d<m.gameboard.missed.length?a(t):(r(t),m.gameboard.ships.forEach((t=>{t.isSunk()&&(t=>{const e=t.location[0][0],a=t.location[0][1];document.querySelector(`.oppCell[data-x="${e}"][data-y="${a}"]`).firstChild.style.opacity=.8})(t)})));const l=o.gameboard.missed.length;let c=m.autoAttack(o.gameboard);for(;!c;)c=m.autoAttack(o.gameboard);const i=document.querySelector(`.userCell[data-x="${c[0]}"][data-y="${c[1]}"]`);l<o.gameboard.missed.length?a(i):r(i)}))}))};let l,c,i,n,u,m="hori",h=1;function p(t){if(6===h)return;const e=parseInt(t.getAttribute("data-x")),a=parseInt(t.getAttribute("data-y"));let r=document.querySelector(`.modalCell[data-x="${e+1}"][data-y="${a}"]`),s=document.querySelector(`.modalCell[data-x="${e+2}"][data-y="${a}"]`),o=document.querySelector(`.modalCell[data-x="${e+3}"][data-y="${a}"]`),d=document.querySelector(`.modalCell[data-x="${e+4}"][data-y="${a}"]`);"vert"===m&&(r=document.querySelector(`.modalCell[data-x="${e}"][data-y="${a+1}"]`),s=document.querySelector(`.modalCell[data-x="${e}"][data-y="${a+2}"]`),o=document.querySelector(`.modalCell[data-x="${e}"][data-y="${a+3}"]`),d=document.querySelector(`.modalCell[data-x="${e}"][data-y="${a+4}"]`));let l=[t,r,s,o,d];l=y(l);let c=!0,i=!1;l.forEach((t=>{t?t.classList.contains("occupied")&&(i=!0):c=!1})),c?(i&&t.classList.remove("placeError"),l.forEach((t=>{t.classList.remove("placeHover")})),t.firstChild&&t.classList.remove("alreadyPlacedError")):t.classList.remove("placeError")}function y(t){return 1===h?t:2===h?t.slice(0,4):3===h||4==h?t.slice(0,3):5===h?t.slice(0,2):void 0}document.querySelectorAll(".board").forEach((t=>{for(let e=0;e<10;e++){let a=document.createElement("div");for(let r=0;r<10;r++){let s=document.createElement("div");s.classList.add("cell"),t.classList.contains("opponent")&&s.classList.add("oppCell"),t.classList.contains("player")&&s.classList.add("userCell"),t.classList.contains("modalBoard")&&s.classList.add("modalCell"),s.dataset.x=r,s.dataset.y=e,a.appendChild(s)}a.classList.add("row"),t.appendChild(a)}})),(()=>{document.querySelectorAll(".modalCell").forEach((t=>{t.addEventListener("mouseenter",(()=>function(t){if(6===h)return;if(t.firstChild)return void t.classList.add("alreadyPlacedError");const e=parseInt(t.getAttribute("data-x")),a=parseInt(t.getAttribute("data-y"));let r=document.querySelector(`.modalCell[data-x="${e+1}"][data-y="${a}"]`),s=document.querySelector(`.modalCell[data-x="${e+2}"][data-y="${a}"]`),o=document.querySelector(`.modalCell[data-x="${e+3}"][data-y="${a}"]`),d=document.querySelector(`.modalCell[data-x="${e+4}"][data-y="${a}"]`);"vert"===m&&(r=document.querySelector(`.modalCell[data-x="${e}"][data-y="${a+1}"]`),s=document.querySelector(`.modalCell[data-x="${e}"][data-y="${a+2}"]`),o=document.querySelector(`.modalCell[data-x="${e}"][data-y="${a+3}"]`),d=document.querySelector(`.modalCell[data-x="${e}"][data-y="${a+4}"]`));let l=[t,r,s,o,d];l=y(l);let c=!0;l.forEach((t=>{t?t.classList.contains("occupied")&&(c=!1):c=!1})),c?l.forEach((t=>{t.classList.add("placeHover")})):t.classList.add("placeError")}(t))),t.addEventListener("mouseleave",(()=>p(t))),t.addEventListener("click",(()=>function(t){if(1===h){const e=parseInt(t.getAttribute("data-x")),a=parseInt(t.getAttribute("data-y"));let r=document.querySelector(`.modalCell[data-x="${e+1}"][data-y="${a}"]`),s=document.querySelector(`.modalCell[data-x="${e+2}"][data-y="${a}"]`),o=document.querySelector(`.modalCell[data-x="${e+3}"][data-y="${a}"]`),d=document.querySelector(`.modalCell[data-x="${e+4}"][data-y="${a}"]`);if("vert"===m&&(r=document.querySelector(`.modalCell[data-x="${e}"][data-y="${a+1}"]`),s=document.querySelector(`.modalCell[data-x="${e}"][data-y="${a+2}"]`),o=document.querySelector(`.modalCell[data-x="${e}"][data-y="${a+3}"]`),d=document.querySelector(`.modalCell[data-x="${e}"][data-y="${a+4}"]`)),!(r&&s&&o&&d))return;const c=[t,r,s,o,d];let i=!1;if(c.forEach((t=>{t.classList.contains("occupied")&&(i=!0)})),i)return;const n=document.createElement("img");return n.classList.add("carrier"),"vert"===m&&n.classList.add("vertical"),n.src="./resources/carrier.png",t.appendChild(n),c.forEach((t=>{t.classList.add("occupied")})),p(t),h++,document.querySelector(".modalTitle").textContent="PLACE YOUR BATTLESHIP",void(l=[e,a,m,5])}if(2===h){const e=parseInt(t.getAttribute("data-x")),a=parseInt(t.getAttribute("data-y"));let r=document.querySelector(`.modalCell[data-x="${e+1}"][data-y="${a}"]`),s=document.querySelector(`.modalCell[data-x="${e+2}"][data-y="${a}"]`),o=document.querySelector(`.modalCell[data-x="${e+3}"][data-y="${a}"]`);if("vert"===m&&(r=document.querySelector(`.modalCell[data-x="${e}"][data-y="${a+1}"]`),s=document.querySelector(`.modalCell[data-x="${e}"][data-y="${a+2}"]`),o=document.querySelector(`.modalCell[data-x="${e}"][data-y="${a+3}"]`)),!r||!s||!o)return;const d=[t,r,s,o];let l=!1;if(d.forEach((t=>{t.classList.contains("occupied")&&(l=!0)})),l)return;const i=document.createElement("img");return i.classList.add("battleship"),"vert"===m&&i.classList.add("vertical"),i.src="./resources/battleship.png",t.appendChild(i),d.forEach((t=>{t.classList.add("occupied")})),p(t),h++,document.querySelector(".modalTitle").textContent="PLACE YOUR CRUISER",void(c=[e,a,m,4])}if(3===h){const e=parseInt(t.getAttribute("data-x")),a=parseInt(t.getAttribute("data-y"));let r=document.querySelector(`.modalCell[data-x="${e+1}"][data-y="${a}"]`),s=document.querySelector(`.modalCell[data-x="${e+2}"][data-y="${a}"]`);if("vert"===m&&(r=document.querySelector(`.modalCell[data-x="${e}"][data-y="${a+1}"]`),s=document.querySelector(`.modalCell[data-x="${e}"][data-y="${a+2}"]`)),!r||!s)return;const o=[t,r,s];let d=!1;if(o.forEach((t=>{t.classList.contains("occupied")&&(d=!0)})),d)return;const l=document.createElement("img");return l.classList.add("cruiser"),"vert"===m&&l.classList.add("vertical"),l.src="./resources/cruiser.png",t.appendChild(l),o.forEach((t=>{t.classList.add("occupied")})),p(t),h++,document.querySelector(".modalTitle").textContent="PLACE YOUR SUBMARINE",void(i=[e,a,m,3])}if(4===h){const e=parseInt(t.getAttribute("data-x")),a=parseInt(t.getAttribute("data-y"));let r=document.querySelector(`.modalCell[data-x="${e+1}"][data-y="${a}"]`),s=document.querySelector(`.modalCell[data-x="${e+2}"][data-y="${a}"]`);if("vert"===m&&(r=document.querySelector(`.modalCell[data-x="${e}"][data-y="${a+1}"]`),s=document.querySelector(`.modalCell[data-x="${e}"][data-y="${a+2}"]`)),!r||!s)return;const o=[t,r,s];let d=!1;if(o.forEach((t=>{t.classList.contains("occupied")&&(d=!0)})),d)return;const l=document.createElement("img");return l.classList.add("submarine"),"vert"===m&&l.classList.add("vertical"),l.src="./resources/submarine.png",t.appendChild(l),o.forEach((t=>{t.classList.add("occupied")})),p(t),h++,document.querySelector(".modalTitle").textContent="PLACE YOUR DESTROYER",void(n=[e,a,m,3])}if(5===h){const e=parseInt(t.getAttribute("data-x")),a=parseInt(t.getAttribute("data-y"));let r=document.querySelector(`.modalCell[data-x="${e+1}"][data-y="${a}"]`);if("vert"===m&&(r=document.querySelector(`.modalCell[data-x="${e}"][data-y="${a+1}"]`)),!r)return;const s=[t,r];let o=!1;if(s.forEach((t=>{t.classList.contains("occupied")&&(o=!0)})),o)return;const l=document.createElement("img");l.classList.add("destroyer"),"vert"===m&&l.classList.add("vertical"),l.src="./resources/destroyer.png",t.appendChild(l),s.forEach((t=>{t.classList.add("occupied")})),p(t),h++,u=[e,a,m,2],document.querySelector(".placeModal").style.display="none",d()}}(t)))}));const t=document.querySelector(".changeAxis");t.addEventListener("click",(()=>{"X"===t.textContent.charAt(6)?(t.textContent="AXIS: Y",m="vert"):(t.textContent="AXIS: X",m="hori")}))})()})();